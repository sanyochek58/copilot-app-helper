# Copilot App Helper

Фуллстек-приложение, которое даёт владельцу микробизнеса своего **ИИ-копилота**:  
помогает быстро отвечать клиентам, писать письма сотрудникам, придумывать идеи и формулировать любые тексты.

Проект состоит из двух микросервисов на Spring Boot, React/Vite-фронтенда и Nginx в качестве reverse-proxy. Всё поднимается одной командой через Docker Compose.

## Содержание

- [Архитектура](#архитектура)
- [Технологии](#технологии)
- [Быстрый запуск (Docker)](#быстрый-запуск-docker)
- [Конфигурация](#конфигурация)
- [Эксплуатация и администрирование](#эксплуатация-и-администрирование)
- [Локальная разработка](#локальная-разработка)
- [Отказ от ответственности](#отказ-от-ответственности)
- [Команда проекта](#команда-проекта)
- [Запуск Telegram-клиента](#запуск-telegram-клиента)
- [Устранение проблем](#устранение-проблем)


Проект состоит из нескольких сервисов, работающих в Docker-контейнерах:

- **`auth-service`** – микросервис для авторизации и аутентификации. Отвечает за регистрацию, вход и управление JWT-токенами.
- **`ai-service`** – основной ИИ-копилот. Использует Spring AI для взаимодействия с LLM, обрабатывает запросы пользователей и **отправляет электронные письма** (например, для коммуникации с клиентами или сотрудниками). Для проверки токенов обращается к `auth-service`. Функционал отправки писем - Сервис `ai-service` расширен функционалом отправки электронных писем. Это позволяет ИИ-копилоту не только генерировать тексты, но и сразу отправлять их адресатам (например, клиентам или сотрудникам), что значительно ускоряет рабочие процессы микробизнеса.
- **`frontend`** – клиентское приложение на React/Vite, предоставляющее пользовательский интерфейс.
- **`postgres`** – база данных PostgreSQL для `auth-service`.
- **`nginx`** – reverse-proxy, который распределяет запросы: отдает статику фронтенда и проксирует API-вызовы на `auth-service` и `ai-service`.

Все сервисы объединены в одну сеть с помощью Docker Compose, что упрощает их взаимодействие.

## Технологии

| Компонент      | Технологии                                                                 |
| :------------- | :------------------------------------------------------------------------- |
| **Backend**    | Java 21, Spring Boot 3, Spring Security, Spring AI, WebClient              |
| **Frontend**   | React, TypeScript, Vite                                                    |
| **База данных** | PostgreSQL                                                                 |
| **Инфраструктура** | Docker, Docker Compose, Nginx                                              |

## Быстрый запуск (Docker)

### 1. Предварительные требования

Убедитесь, что на вашем компьютере установлены:

- [Docker](https://www.docker.com/get-started)
- [Docker Compose](https://docs.docker.com/compose/install/)

### 2. Клонирование репозитория

```bash
git clone https://github.com/sanyochek58/copilot-app-helper.git
cd copilot-app-helper
```

### 3. Конфигурация

Перед первым запуском необходимо сконфигурировать переменные окружения. Основные параметры находятся в файле `docker-compose.yml`.

**Важно:** Укажите ваш `OPENAI_API_KEY` в `docker-compose.yml` для сервиса `ai-service`:

```yaml
ai-service:
  # ...
  environment:
    - OPENAI_API_KEY=ваш_ключ_сюда
```

### 4. Сборка и запуск

Выполните следующую команду, чтобы собрать образы и запустить все сервисы в фоновом режиме:

```bash
docker compose up -d --build
```

После успешного запуска приложение будет доступно по адресу [http://localhost:4000](http://localhost:4000).

### 5. Доступ через интернет (ngrok)

Если вам нужно предоставить временный доступ к приложению извне (например, для демонстрации), вы можете использовать [ngrok](https://ngrok.com/).

```bash
ngrok http 4000
```

Ngrok сгенерирует публичную ссылку, по которой ваше приложение будет доступно.

## Конфигурация

Все основные параметры конфигурации находятся в файле `docker-compose.yml` в виде переменных окружения.

| Сервис         | Переменная                  | Описание                                                                  |
| :------------- | :-------------------------- | :------------------------------------------------------------------------ |
| `postgres`     | `POSTGRES_DB`               | Имя базы данных.                                                          |
|                | `POSTGRES_USER`             | Имя пользователя для подключения к БД.                                    |
|                | `POSTGRES_PASSWORD`         | Пароль для подключения к БД.                                              |
| `auth-service` | `SPRING_DATASOURCE_URL`     | URL для подключения к PostgreSQL.                                         |
|                | `APP_JWT_SECRET`            | Секретный ключ для генерации JWT-токенов. **Должен быть одинаковым** с `ai-service`. |
|                | `APP_JWT_EXPIRATION_SECOND` | Время жизни JWT-токена в секундах.                                        |
| `ai-service`   | `APP_JWT_SECRET`            | Секретный ключ для валидации JWT-токенов. **Должен быть одинаковым** с `auth-service`. |
|                | `OPENAI_API_KEY`            | Ваш API-ключ от OpenAI.                                                   |
| `frontend`     | `VITE_AUTH_SERVICE_URL`     | URL для запросов к `auth-service`.                                        |
|                | `VITE_AI_SERVICE_URL`       | URL для запросов к `ai-service`.                                          |

## Эксплуатация и администрирование

### Просмотр логов

Для просмотра логов всех запущенных сервисов в реальном времени используйте команду:

```bash
docker compose logs -f
```

Чтобы посмотреть логи конкретного сервиса (например, `ai-service`):

```bash
docker compose logs -f ai-service
```

### Остановка и удаление контейнеров

Для остановки всех сервисов выполните:

```bash
docker compose down
```

Если вы хотите также удалить все данные (включая данные в PostgreSQL), добавьте флаг `-v`:

```bash
docker compose down -v
```

## Локальная разработка

Если вы хотите запускать сервисы локально без Docker, вам потребуется:

- Java 21+
- Node.js 18+

1.  **Запустите PostgreSQL:** Вы можете использовать Docker для запуска только базы данных:

    ```bash
    docker compose up -d postgres
    ```

2.  **Запустите `auth-service` и `ai-service`:**
    - Откройте каждый проект в вашей IDE (например, IntelliJ IDEA).
    - Установите необходимые переменные окружения для каждого сервиса.
    - Запустите каждое Spring Boot приложение.

3.  **Запустите `frontend`:**

    ```bash
    cd CHAT-WEBAPP
    npm install
    npm run dev
    ```

## Отказ от ответственности

В данном проекте используются ключи доступа к внешним сервисам в ознакомительных целях. Использование этих ключей в противоправных целях, включая, но не ограничиваясь, нарушением законодательства об авторском праве и коммерческой тайны, строго запрещено. Любые неправомерные действия будут преследоваться в соответствии с действующим законодательством.


## Запуск Telegram-клиента

Для запуска Telegram-клиента, который взаимодействует с вашим локально развернутым приложением, выполните следующие шаги:

1.  **Запустите туннель ngrok** для порта `4000`, на котором работает Nginx:

    ```bash
    ngrok http 4000
    ```

2.  **Получите публичный URL** от ngrok (он будет выглядеть примерно так: `https://xxxx-xxxx-xxxx-xxxx.ngrok-free.app`).

3.  **Перейдите к боту:** Откройте Telegram и перейдите к боту **@help_copilot_bot**.

4.  **Используйте публичный URL** для взаимодействия с ботом. (Предполагается, что бот настроен на использование этого URL в качестве webhook или имеет возможность принять его через команду).

## Устранение проблем

- **Ошибка `port is already allocated`:** Убедитесь, что порты, указанные в `docker-compose.yml` (4000, 5432, 8081, 8082, 3000), не заняты другими приложениями на вашем компьютере.
- **Сервис не запускается:** Проверьте логи сервиса с помощью `docker compose logs -f <имя_сервиса>`, чтобы выявить причину проблемы.
- **Проблемы с подключением к OpenAI:** Убедитесь, что вы правильно указали `OPENAI_API_KEY` и что у вас есть доступ к API OpenAI.


## Команда проекта

- **Бураев Александр** - Backend Developer(leader)
- **Петраков Артём** - Backend Developer
- **Максим Плотников** - UX/UI
- **Базылева Анастасия** - Frontend Developer & Project Manager(leader)


live
